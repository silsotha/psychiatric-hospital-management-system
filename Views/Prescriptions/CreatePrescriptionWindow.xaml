<Window x:Class="PsychiatricHospitalWPF.Views.Prescriptions.CreatePrescriptionWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Создание назначения" 
        Height="800" Width="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Шапка -->
        <Border Grid.Row="0" Background="#673AB7" Padding="15">
            <StackPanel>
                <TextBlock Text="Новое назначение" 
                          FontSize="16" 
                          FontWeight="Bold" 
                          Foreground="White"/>
                <TextBlock x:Name="txtPatientName" 
                          Text="" 
                          FontSize="12" 
                          Foreground="White"
                          Opacity="0.9"
                          Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <!-- Форма -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20">

                <!-- Тип назначения -->
                <Label Content="Тип назначения:*" FontWeight="SemiBold"/>
                <ComboBox x:Name="cmbPrescriptionType" 
                         Height="35"
                         Margin="0,0,0,5"
                         SelectionChanged="CmbPrescriptionType_SelectionChanged">
                    <ComboBoxItem Content="💊 Медикамент" Tag="Медикамент" IsSelected="True"/>
                    <ComboBoxItem Content="🏥 Процедура" Tag="Процедура"/>
                </ComboBox>
                <TextBlock Text="Выберите тип назначения"
                          FontSize="11"
                          Foreground="Gray"
                          Margin="5,0,0,15"/>

                <!-- Название -->
                <Label Content="Название препарата/процедуры:*" FontWeight="SemiBold"/>
                <TextBox x:Name="txtName" 
                        Height="35"
                        Padding="10"
                        Margin="0,0,0,15"/>

                <!-- Дозировка (только для медикаментов) -->
                <StackPanel x:Name="panelDosage">
                    <Label Content="Дозировка:*" FontWeight="SemiBold"/>
                    <TextBox x:Name="txtDosage" 
                            Height="35"
                            Padding="10"
                            Margin="0,0,0,5"/>
                    <TextBlock Text="Например: 10 мг, 5 мл, 1 таблетка"
                              FontSize="11"
                              Foreground="Gray"
                              Margin="5,0,0,15"/>
                </StackPanel>

                <!-- Периодичность -->
                <Label Content="Периодичность приема:*" FontWeight="SemiBold"/>
                <ComboBox x:Name="cmbFrequency" 
                         Height="35"
                         Margin="0,0,0,5">
                    <ComboBoxItem Content="Один раз в день" IsSelected="True"/>
                    <ComboBoxItem Content="Два раза в день (утро, вечер)"/>
                    <ComboBoxItem Content="Три раза в день (утро, день, вечер)"/>
                    <ComboBoxItem Content="Четыре раза в день (каждые 6 часов)"/>
                    <ComboBoxItem Content="По необходимости"/>
                </ComboBox>
                <TextBlock Text="Выберите как часто выполнять назначение"
                          FontSize="11"
                          Foreground="Gray"
                          Margin="5,0,0,15"/>

                <!-- Длительность курса -->
                <Label Content="Длительность курса (дней):*" FontWeight="SemiBold"/>
                <TextBox x:Name="txtDuration" 
                        Height="35"
                        Padding="10"
                        Margin="0,0,0,5"
                        PreviewTextInput="TxtDuration_PreviewTextInput"/>
                <TextBlock Text="Введите количество дней (например: 7, 14, 30)"
                          FontSize="11"
                          Foreground="Gray"
                          Margin="5,0,0,15"/>

                <!-- Дата начала -->
                <Label Content="Дата начала:*" FontWeight="SemiBold"/>
                <DatePicker x:Name="dpStartDate" 
                           Height="35"
                           Padding="8"
                           Margin="0,0,0,5"/>
                <TextBlock Text="По умолчанию сегодня"
                          FontSize="11"
                          Foreground="Gray"
                          Margin="5,0,0,15"/>

                <!-- Примечания -->
                <Label Content="Примечания:" FontWeight="SemiBold"/>
                <TextBox x:Name="txtNotes" 
                        Height="35"
                        Padding="10"
                        TextWrapping="Wrap"
                        AcceptsReturn="True"
                        VerticalScrollBarVisibility="Auto"
                        Margin="0,0,0,5"/>
                <TextBlock Text="Дополнительные указания (опционально)"
                          FontSize="11"
                          Foreground="Gray"
                          Margin="5,0,0,15"/>

                <!-- Информационная панель -->
                <Border Background="#E8F5E9" 
                       BorderBrush="#4CAF50" 
                       BorderThickness="1"
                       Padding="10"
                       Margin="0,5,0,0">
                    <StackPanel>
                        <TextBlock Text="ℹ️ Информация:" 
                                  FontWeight="SemiBold"
                                  Foreground="#2E7D32"/>
                        <TextBlock Margin="15,5,0,0" TextWrapping="Wrap">
                            <Run Text="• Поля с * обязательны для заполнения"/>
                        </TextBlock>
                        <TextBlock Margin="15,2,0,0" TextWrapping="Wrap">
                            <Run Text="• Дата окончания рассчитывается автоматически"/>
                        </TextBlock>
                        <TextBlock Margin="15,2,0,0" TextWrapping="Wrap">
                            <Run Text="• Статус назначения будет: Активно"/>
                        </TextBlock>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>

        <!-- Кнопки -->
        <Border Grid.Row="2" Background="#f5f5f5" Padding="15" BorderBrush="#ddd" BorderThickness="0,1,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="lblError" 
                          Grid.Column="0"
                          Text=""
                          Foreground="Red"
                          VerticalAlignment="Center"
                          TextWrapping="Wrap"
                          Visibility="Collapsed"/>

                <Button x:Name="btnSave" 
                       Content="✓ Создать назначение" 
                       Grid.Column="1"
                       Click="BtnSave_Click"
                       Background="#4CAF50"
                       Foreground="White"
                       Padding="20,8"
                       Margin="5,0"
                       Cursor="Hand"/>

                <Button x:Name="btnCancel" 
                       Content="✗ Отмена" 
                       Grid.Column="2"
                       Click="BtnCancel_Click"
                       Background="#757575"
                       Foreground="White"
                       Padding="20,8"
                       Margin="5,0"
                       Cursor="Hand"/>
            </Grid>
        </Border>
    </Grid>
</Window>
